import{r as n,j as e,a as $,u as U,F as M,f as pe,L as A,b as V,c as ee,d as se,e as ae,g as re,h as fe,i as xe,k as je,l as te,m as be,n as ne,o as ge,p as ve,O as oe,q as ie,s as W,t as Ne,v as we,w as ye,x as Ee,y as O,z as Ce,N as le,B as Se,R as ke,A as I,C as ze}from"./vendor-C6fDhUMH.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))m(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&m(l)}).observe(document,{childList:!0,subtree:!0});function c(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function m(o){if(o.ep)return;o.ep=!0;const i=c(o);fetch(o.href,i)}})();const ce=n.createContext(),qe=({children:s})=>{const[a,c]=n.useState([]),m=async()=>{try{const r=await $.get("https://backend-mywf.onrender.com/api/festividad/festividades");c(r.data)}catch(t){console.error("❌ Error al listar los eventos:",t),setTimeout(()=>m(),5e3)}},o=async t=>{try{const r=`https://backend-mywf.onrender.com/api/festividad/detalle/${t}`;return(await $.get(r)).data}catch(r){throw console.error("❌ Error al obtener detalle del evento:",r),r}},i=async t=>{try{const r=localStorage.getItem("token"),p="https://backend-mywf.onrender.com/api/festividad/crear",y={headers:{Authorization:`Bearer ${r}`}};return(await $.post(p,t,y)).data}catch(r){throw console.error("❌ Error al crear el evento:",r),r}},l=async(t,r)=>{try{const p=localStorage.getItem("token"),y=`https://backend-mywf.onrender.com/api/festividad/actualizar/${t}`,N={headers:{Authorization:`Bearer ${p}`}};return(await $.put(y,r,N)).data}catch(p){throw console.error("❌ Error al actualizar el evento:",p),p}},b=async t=>{try{const r=localStorage.getItem("token"),p=`https://backend-mywf.onrender.com/api/festividad/eliminar/${t}`,y={headers:{Authorization:`Bearer ${r}`}};return(await $.delete(p,y)).data}catch(r){throw console.error("❌ Error al eliminar el evento:",r),r}},d=async t=>{try{const r=`https://backend-mywf.onrender.com/api/festividad/festividades-por-mes/${t}`;return(await $.get(r)).data}catch(r){throw console.error("❌ Error al listar eventos por mes:",r),r}};return n.useEffect(()=>{m()},[]),e.jsx(ce.Provider,{value:{eventos:a,listarEventos:m,obtenerDetalleEvento:o,crearEvento:i,actualizarEvento:l,eliminarEvento:b,listarEventosPorMes:d},children:s})},Ae=({toggleSidebar:s})=>{const[a,c]=n.useState(!1),[m,o]=n.useState(null),[i,l]=n.useState(!1),[b,d]=n.useState(null),[t,r]=n.useState([]),{listarEventosPorMes:p}=n.useContext(ce),y=U();n.useEffect(()=>{const x=localStorage.getItem("token"),C=localStorage.getItem("tipoUsuario");c(!!x),o(C)},[]);const N=()=>{localStorage.removeItem("token"),localStorage.removeItem("tipoUsuario"),c(!1),o(null),y("/"),window.location.reload()},w=async x=>{d(x);try{const C=await p(x);r(C[x]||[])}catch(C){console.error("Error al obtener festividades del mes:",C)}},v=()=>{d(null),r([])},g=()=>{l(!i)},f=x=>{y(`/searches?month=${x}`)},j=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];return e.jsxs("nav",{className:"navbar px-4",children:[e.jsx("button",{className:"menu-btn",onClick:s,children:e.jsx(M,{icon:pe})}),e.jsxs(A,{to:"/",className:"navbar-logo",children:[e.jsx("img",{src:"/logo.png",alt:"Logo"}),e.jsx("span",{className:"navbar-title",children:"Megadisfraz"})]}),e.jsx("ul",{className:"navbar-meses",children:j.map(x=>e.jsxs("li",{className:"nav-item",onMouseEnter:()=>w(x),onMouseLeave:v,children:[e.jsx("button",{className:"month-link",onClick:()=>f(x),children:x}),b===x&&t.length>0&&e.jsxs("div",{className:"event-dropdown",children:[e.jsx("div",{className:"event-dropdown-header",children:e.jsxs("h4",{children:["Eventos en ",x]})}),e.jsx("ul",{className:"event-list",children:t.map(C=>e.jsxs("li",{className:"event-item",onClick:()=>y(`/searches?event=${encodeURIComponent(C.nombre)}`),children:[e.jsx("span",{className:"event-day",children:C.dia}),e.jsxs("div",{children:[e.jsx("div",{className:"event-name",children:C.nombre}),C.descripcion&&e.jsx("div",{className:"event-desc",children:C.descripcion})]})]},C.id))})]})]},x))}),e.jsx("div",{className:"navbar-auth",children:a?e.jsxs(e.Fragment,{children:[e.jsx(A,{to:"/perfil",className:"icon-btn profile-icon",title:"Perfil",children:e.jsx(M,{icon:ee})}),e.jsx("button",{className:"icon-btn logout-icon",onClick:N,title:"Cerrar Sesión",children:e.jsx(M,{icon:se})}),(m==="admin"||m==="moderador")&&e.jsxs("div",{className:"admin-menu-container",children:[e.jsxs("button",{className:"icon-btn admin-icon",onClick:g,title:"Administrador",children:[e.jsx(M,{icon:ae})," ",e.jsx(M,{icon:re})]}),i&&e.jsxs("div",{className:"admin-menu",children:[m==="admin"&&e.jsx(A,{to:"/administradores",className:"admin-menu-item",children:"Administradores"}),e.jsx(A,{to:"/eventos",className:"admin-menu-item",children:"Eventos"}),e.jsx(A,{to:"/disfraces",className:"admin-menu-item",children:"Disfraces"}),e.jsx(A,{to:"/etiquetas",className:"admin-menu-item",children:"Etiquetas"})]})]})]}):e.jsx(A,{to:"/login",className:"icon-btn login-icon",title:"Iniciar Sesión",children:e.jsx(M,{icon:V})})})]})},B=n.createContext(),De=({children:s})=>{const[a,c]=n.useState([]),m=async()=>{try{const r=await $.get("https://backend-mywf.onrender.com/api/disfraz/listar");c(r.data)}catch(t){console.error("❌ Error al listar los disfraces:",t),setTimeout(()=>m(),5e3)}},o=async t=>{try{const r=`https://backend-mywf.onrender.com/api/disfraz/detalle/${t}`;return(await $.get(r)).data}catch(r){throw console.error("❌ Error al obtener detalle del disfraz:",r),r}},i=async t=>{try{const r=localStorage.getItem("token"),p="https://backend-mywf.onrender.com/api/disfraz/registro",y={headers:{Authorization:`Bearer ${r}`}};return(await $.post(p,t,y)).data}catch(r){throw console.error("❌ Error al registrar disfraz:",r),r}},l=async(t,r)=>{try{const p=localStorage.getItem("token"),y=`https://backend-mywf.onrender.com/api/disfraz/actualizar/${t}`,N={headers:{Authorization:`Bearer ${p}`}};return(await $.put(y,r,N)).data}catch(p){throw console.error("❌ Error al actualizar el disfraz:",p),p}},b=async t=>{try{const r=localStorage.getItem("token"),p=`https://backend-mywf.onrender.com/api/disfraz/eliminar/${t}`,y={headers:{Authorization:`Bearer ${r}`}};return(await $.delete(p,y)).data}catch(r){throw console.error("❌ Error al eliminar el disfraz:",r),r}},d=t=>a.filter(r=>r.categoria===t);return n.useEffect(()=>{m()},[]),e.jsx(B.Provider,{value:{disfraces:a,setDisfraces:c,listarDisfraces:m,obtenerDetalleDisfraz:o,registrarDisfraz:i,actualizarDisfraz:l,eliminarDisfraz:b,filtrarDisfracesPorCategoria:d},children:s})},$e="/assets/localYaruki1-D10HE0EN.jpg",Fe="/assets/localYaruki2-xWW1MeEk.jpg",Ie="/assets/localCayambe-BEwHE01a.jpg",H=[{label:"1ra Sucursal: YARUQUI CENTRO",src:"https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d249.3626477649494!2d-78.31752496658034!3d-0.16204089881778425!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x91d593004a7fa75f%3A0x5eea80851419080a!2sMegadisfraz!5e0!3m2!1ses-419!2sec!4v1740273750468!5m2!1ses-419!2sec",image:$e},{label:"2da Sucursal: CAYAMBE CENTRO",src:"https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d296.54494697342307!2d-78.14407258761588!3d0.04045211760451157!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x8e2a08f745888e7b%3A0x836a42c1eea0bfb1!2sCentro%20Comercial%20de%20Vendedores%20Aut%C3%B3nomos!5e0!3m2!1ses-419!2sec!4v1740273826714!5m2!1ses-419!2sec",image:Ie},{label:"3ra Sucursal: YARUQUI - UPC",src:"https://www.google.com/maps/embed?pb=!1m14!1m12!1m3!1d249.36266087396976!2d-78.3181939994935!3d-0.16097235436319585!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!5e0!3m2!1ses-419!2sec",image:Fe}];function de(){const[s,a]=n.useState(H[0].src),[c,m]=n.useState(H[0]);return e.jsxs("div",{className:"mapa-wrapper",children:[e.jsx("h2",{className:"sidebar-title",children:"Mapa Sucursales"}),e.jsxs("div",{className:"mapa-layout",children:[e.jsx("ul",{className:"sucursales-list",children:H.map((o,i)=>e.jsx("li",{onClick:()=>m(o),children:o.label},i))}),e.jsx("div",{className:"map-container",children:e.jsx("iframe",{title:"mapa-sucursales",src:c.src,width:"100%",height:"200",style:{border:0},allowFullScreen:!0,loading:"lazy",referrerPolicy:"no-referrer-when-downgrade"})}),e.jsx("div",{className:"local-image",children:e.jsx("img",{src:c.image,alt:`Local de ${c.label}`})})]}),e.jsxs("div",{className:"social-icons",children:[e.jsx("a",{href:"https://www.instagram.com/megadisfraz_yaruqui?igsh=dHJwd3hmaHU2aTNq",children:e.jsx(fe,{})}),e.jsx("a",{href:"https://x.com/Megadisfraz?t=IxW60maTBR2FoOO_RNDDeQ&s=09",children:e.jsx(xe,{})}),e.jsx("a",{href:"https://www.tiktok.com/@megadisfraz_yaruqui?_t=ZM-8wGmbrvw46Y&_r=1",children:e.jsx(je,{})}),e.jsx("a",{href:"https://wa.me/593939232766",children:e.jsx(te,{})}),e.jsx("a",{href:"webmegadisfraz513@gmail.com",children:e.jsx(be,{})})]}),e.jsx("p",{className:"footer-text",children:"© 2025 Megadisfraz"})]})}const Me=({sidebarOpen:s,toggleSidebar:a})=>{const[c,m]=n.useState([]),[o,i]=n.useState(""),[l,b]=n.useState(!1),d=U(),t=ne(),{disfraces:r}=n.useContext(B),p=localStorage.getItem("tipoUsuario"),y=()=>{b(v=>!v)};n.useEffect(()=>{(async()=>{try{const g=await fetch("https://backend-mywf.onrender.com/api/etiqueta/listar",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!g.ok)throw new Error("Error al obtener las etiquetas");const f=await g.json();m(f)}catch(g){console.error("Error al cargar las etiquetas:",g)}})()},[]);const N=v=>{const g=new URLSearchParams(t.search);g.set("etiqueta",v),d(`/searches?${g.toString()}`),a()},w=()=>{o.trim()&&r.filter(g=>g.nombre.toLowerCase().includes(o.toLowerCase())||g.descripcion.toLowerCase().includes(o.toLowerCase())).length>0&&(d(`/searches?query=${o}`),a())};return n.useEffect(()=>(s?document.body.classList.add("sidebar-open"):document.body.classList.remove("sidebar-open"),()=>document.body.classList.remove("sidebar-open")),[s]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`overlay ${s?"active":""}`,onClick:a}),e.jsxs("aside",{className:`sidebar ${s?"active":""}`,children:[e.jsxs("div",{className:"sidebar-top",children:[e.jsx("button",{className:"close-btn",onClick:a,children:e.jsx(M,{icon:ge})}),e.jsx("div",{className:"sidebar-auth-icons",children:localStorage.getItem("token")?e.jsxs("div",{className:"auth-icons-wrapper",children:[e.jsx(A,{to:"/perfil",className:"icon-btn profile-icon",title:"Perfil",children:e.jsx(M,{icon:ee})}),e.jsx("button",{className:"icon-btn logout-icon",title:"Cerrar Sesión",onClick:()=>{localStorage.clear(),window.location.reload()},children:e.jsx(M,{icon:se})}),(p==="admin"||p==="moderador")&&e.jsxs("div",{className:"admin-menu-container",children:[e.jsxs("button",{className:"icon-btn admin-icon",onClick:y,title:"Administrador",children:[e.jsx(M,{icon:ae})," ",e.jsx(M,{icon:re})]}),l&&e.jsxs("div",{className:"admin-menu",children:[p==="admin"&&e.jsx(A,{to:"/administradores",className:"admin-menu-item",children:"Administradores"}),e.jsx(A,{to:"/eventos",className:"admin-menu-item",children:"Eventos"}),e.jsx(A,{to:"/disfraces",className:"admin-menu-item",children:"Disfraces"}),e.jsx(A,{to:"/etiquetas",className:"admin-menu-item",children:"Etiquetas"})]})]})]}):e.jsx(A,{to:"/login",className:"icon-btn login-icon",title:"Iniciar Sesión",children:e.jsx(M,{icon:V})})})]}),e.jsxs("div",{className:"search-container",children:[e.jsx("input",{type:"text",placeholder:"Buscar",value:o,onChange:v=>i(v.target.value),onKeyDown:v=>{v.key==="Enter"&&(v.preventDefault(),w())},className:"search-input"}),e.jsx("button",{className:"search-btn",onClick:w,children:e.jsx(M,{icon:ve})})]}),e.jsx("h2",{className:"sidebar-title",children:"Etiquetas"}),e.jsx("div",{className:"tags-container",children:c.map(v=>e.jsx("button",{className:"tag-button",onClick:()=>N(v.nombre),children:v.nombre},v.id))})]})]})},Pe=()=>e.jsxs("footer",{className:"footer",children:[e.jsxs("ul",{className:"footer-links",children:[e.jsx("li",{children:e.jsxs("a",{href:"https://wa.me/593939232766",children:[e.jsx(te,{}),"Whatsapp."]})}),e.jsx("li",{children:e.jsx("a",{href:"webmegadisfraz513@gmail.com",children:"Gmail."})})]}),e.jsx("p",{className:"footer-text",children:"© 2025 Megadisfraz"})]}),Le=()=>{const[s,a]=n.useState(!1),c=()=>{a(!s)};return e.jsxs("div",{className:"parent",children:[e.jsxs("div",{className:"div1",children:[" ",e.jsx(Ae,{toggleSidebar:c})]}),e.jsx(Me,{sidebarOpen:s,toggleSidebar:c}),e.jsxs("div",{className:"div3",children:[e.jsx(oe,{})," "]}),e.jsxs("div",{className:"div4",children:[" ",e.jsx(Pe,{})]})]})},me=n.createContext(),Ue=({children:s})=>{const[a,c]=n.useState({}),m=async l=>{try{const d="https://backend-mywf.onrender.com/api",t=localStorage.getItem("tipoUsuario");if(!t)throw new Error("Tipo de usuario no definido");const r=`${d}/admin/perfil`,p={headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`}},y=await $.get(r,p);return c({usuario:y.data,rol:t}),y.data}catch(d){throw console.error("❌ Error al obtener el perfil:",d),d}},o=async(l,b)=>{try{const d=localStorage.getItem("token"),r=localStorage.getItem("tipoUsuario")==="admin"?`https://backend-mywf.onrender.com/api/admin/actualizar/${l}`:`https://backend-mywf.onrender.com/api/usuario/actualizar/${l}`,p={headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`}},y=await $.put(r,b,p);return c(y.data),y.data}catch(d){throw console.error("❌ Error al actualizar el perfil:",d),d}},i=async l=>{try{const b=localStorage.getItem("token"),t=localStorage.getItem("tipoUsuario")==="admin"?"https://backend-mywf.onrender.com/api/admin/actualizar-password":"https://backend-mywf.onrender.com/api/usuario/actualizar-password",r={headers:{"Content-Type":"application/json",Authorization:`Bearer ${b}`}};return(await $.put(t,l,r)).data}catch(b){throw console.error("❌ Error al actualizar la contraseña:",b),b}};return n.useEffect(()=>{const l=localStorage.getItem("token");l&&m(l)},[]),e.jsx(me.Provider,{value:{auth:a,setAuth:c,obtenerPerfil:m,actualizarPerfil:o,actualizarPassword:i},children:s})};function G({className:s,children:a,...c}){return e.jsx("div",{className:ie("bg-white rounded-xl shadow-lg overflow-hidden h-full transform transition-transform hover:scale-105",s),style:{border:"1px solid #ccc",boxShadow:"0 4px 8px rgba(10, 10, 10, 0.78)",transition:"transform 0.3s ease"},...c,children:a})}function Y({className:s,children:a,...c}){return e.jsx("div",{className:ie("p-4 h-full",s),...c,children:a})}function Q(s){if(typeof s=="string")try{const a=JSON.parse(s);return Array.isArray(a)?a:[]}catch(a){return console.warn("normalizeImages: error al parsear",a),[]}return Array.isArray(s)?s:[]}function R({imagenes:s,index:a=0,alt:c="",className:m="",style:o={},placeholder:i="/placeholder-image.jpg",loading:l="lazy",...b}){const d=Q(s),[t,r]=n.useState(d[a]||i);return e.jsx("img",{src:t,alt:c,className:m,style:o,loading:l,onError:()=>r(i),...b})}function Re(){const s=U(),{disfraces:a=[]}=n.useContext(B),c=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],m=c[new Date().getMonth()],o=t=>{const r=[...c],p=r.indexOf(m),y=[...r.slice(p),...r.slice(0,p)].reverse();return[...t].sort((N,w)=>{if(!N.festividades||!w.festividades)return 0;const v=g=>{let f=-1;return g.festividades.forEach(j=>{const x=y.indexOf(j.mes);x>f&&(f=x)}),f};return v(w)-v(N)})},i=t=>[...t].sort((r,p)=>{if(!r.festividades||!p.festividades)return 0;const y=N=>{const w=N.festividades.filter(v=>v.mes===m);return w.length?Math.min(...w.map(v=>v.dia)):1/0};return y(r)-y(p)}),l=a.length?i(a.filter(t=>{var r;return(r=t.festividades)==null?void 0:r.some(p=>p.mes===m)})):[],b=o(a),d=t=>{s(`/productos/${t.id}`)};return e.jsxs("div",{className:"store-container",children:[e.jsx("section",{className:"carousel-section",style:{maxWidth:"90%",margin:"auto"},children:e.jsxs("div",{id:"carouselExampleCaptions",className:"carousel slide w-100 ","data-bs-ride":"carousel",children:[e.jsx("div",{className:"carousel-indicators",children:a.map((t,r)=>e.jsx("button",{type:"button","data-bs-target":"#carouselExampleCaptions","data-bs-slide-to":r,className:r===0?"active":"","aria-current":r===0?"true":"false","aria-label":`Slide ${r+1}`},r))}),e.jsx("div",{className:"carousel-inner",children:a.map((t,r)=>e.jsxs("div",{className:`carousel-item ${r===0?"active":""}`,onClick:()=>d(t),style:{cursor:"pointer"},children:[e.jsx(R,{imagenes:t.imagenes,alt:t.nombre,className:"d-block w-100",style:{height:"500px",objectFit:"cover"}}),e.jsx("div",{className:"carousel-caption d-none d-md-block",children:e.jsx("h5",{children:t.nombre})})]},t.id))}),e.jsxs("button",{className:"carousel-control-prev",type:"button","data-bs-target":"#carouselExampleCaptions","data-bs-slide":"prev",children:[e.jsx("span",{className:"carousel-control-prev-icon","aria-hidden":"true"}),e.jsx("span",{className:"visually-hidden",children:"Previous"})]}),e.jsxs("button",{className:"carousel-control-next",type:"button","data-bs-target":"#carouselExampleCaptions","data-bs-slide":"next",children:[e.jsx("span",{className:"carousel-control-next-icon","aria-hidden":"true"}),e.jsx("span",{className:"visually-hidden",children:"Next"})]})]})}),e.jsxs("section",{className:"new-arrivals",children:[e.jsxs("h2",{className:"titulo",children:["Disfraces de ",m]}),e.jsx("div",{className:"new-arrivals-container",children:l.length?l.map(t=>e.jsxs(G,{className:"new-arrival-card",onClick:()=>d(t),children:[e.jsx(R,{imagenes:t.imagenes,alt:t.nombre,className:"arrival-image"}),e.jsx(Y,{children:e.jsx("p",{children:t.nombre})})]},t.id)):e.jsxs("p",{className:"no-disfraces",children:["No hay disfraces disponibles para ",m,"."]})})]}),e.jsx(de,{}),e.jsxs("section",{className:"all-disfraces",children:[e.jsx("h2",{className:"all-title",children:"Todos los Disfraces"}),e.jsx("div",{className:"all-container",children:b.length?b.map(t=>{var r;return(r=t.festividades)==null||r.reduce((p,y)=>{const N=c.indexOf(p.mes);return c.indexOf(y.mes)>N?y:p},{mes:"Enero",dia:1}),e.jsxs(G,{className:"all-card",onClick:()=>d(t),children:[e.jsx(R,{imagenes:t.imagenes,alt:t.nombre,className:"all-image"}),e.jsx(Y,{children:e.jsx("p",{children:t.nombre})})]},t.id)}):e.jsx("p",{className:"no-disfraces",children:"Cargando disfraces..."})})]})]})}const Te=()=>{var q,F;const{obtenerDetalleDisfraz:s,disfraces:a}=n.useContext(B),{id:c}=W(),m=U(),[o,i]=n.useState(null),[l,b]=n.useState(!0),[d,t]=n.useState(null),r=u=>`${u.nombre} - ${u.dia} de ${u.mes}`,p=u=>{const h=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];return[...u].sort((E,z)=>{const S=h.indexOf(E.mes),k=h.indexOf(z.mes);return S!==k?S-k:E.dia-z.dia})};if(n.useEffect(()=>{(async()=>{var u;try{b(!0);const h=await s(c);(u=h==null?void 0:h.festividades)!=null&&u.length&&(h.festividades=p(h.festividades)),i(h||null)}catch{t("Error al cargar los detalles del producto")}finally{b(!1)}})()},[c,s]),l)return e.jsx("div",{className:"loading-message",children:"Cargando detalles del producto..."});if(d)return e.jsx("div",{className:"error-message",children:d});if(!o)return e.jsx("div",{className:"producto-no-encontrado",children:"Producto no encontrado"});const y=Q(o.imagenes),N=(u,h)=>{const E=new Set(h.map(z=>z.id));return u.filter(z=>!E.has(z.id))},w=a.filter(u=>u.id!==Number(c)),v=w.filter(u=>{var h;return(h=u.etiquetas)==null?void 0:h.some(E=>{var z;return(z=o.etiquetas)==null?void 0:z.some(S=>S.id===E.id)})}),g=w.filter(u=>{var h;return(h=u.festividades)==null?void 0:h.some(E=>{var z;return(z=o.festividades)==null?void 0:z.some(S=>E.nombre===S.nombre&&E.dia===S.dia&&E.mes===S.mes)})}),f=N(g,v),j=w.filter(u=>{var h;return(h=u.festividades)==null?void 0:h.some(E=>{var z;return(z=o.festividades)==null?void 0:z.some(S=>E.mes===S.mes)})}),x=N(N(j,v),f),C=u=>m(`/productos/${u.id}`);return e.jsxs("div",{className:"product-detail-wrapper",children:[e.jsxs("div",{className:"parent-ProductDetail",children:[e.jsx("div",{className:"product-img",children:e.jsxs("div",{id:"carouselExampleIndicators",className:"carousel slide w-100","data-bs-ride":"carousel",children:[e.jsx("div",{className:"carousel-indicators",children:y.map((u,h)=>e.jsx("button",{type:"button","data-bs-target":"#carouselExampleIndicators","data-bs-slide-to":h,className:h===0?"active":"","aria-current":h===0?"true":void 0,"aria-label":`Slide ${h+1}`},h))}),e.jsx("div",{className:"carousel-inner",children:y.map((u,h)=>e.jsx("div",{className:`carousel-item ${h===0?"active":""}`,children:e.jsx(R,{imagenes:o.imagenes,index:h,alt:o.nombre,className:"d-block w-100"})},h))}),y.length>1&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"carousel-control-prev",type:"button","data-bs-target":"#carouselExampleIndicators","data-bs-slide":"prev",children:[e.jsx("span",{className:"carousel-control-prev-icon","aria-hidden":"true"}),e.jsx("span",{className:"visually-hidden",children:"Previous"})]}),e.jsxs("button",{className:"carousel-control-next",type:"button","data-bs-target":"#carouselExampleIndicators","data-bs-slide":"next",children:[e.jsx("span",{className:"carousel-control-next-icon","aria-hidden":"true"}),e.jsx("span",{className:"visually-hidden",children:"Next"})]})]})]})}),e.jsxs("div",{className:"product-info",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Nombre:"})," ",o.nombre]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Descripción:"})," ",o.descripcion||"No hay descripción disponible."]}),e.jsx("p",{children:e.jsx("strong",{children:"Evento:"})}),(q=o.festividades)!=null&&q.length?e.jsx("ul",{className:"festividades-list",children:o.festividades.map((u,h)=>e.jsx("li",{children:r(u)},h))}):e.jsx("p",{children:"Evento no disponible"}),e.jsx("p",{children:e.jsx("strong",{children:"Etiquetas:"})}),e.jsx("ul",{className:"product-prendas",children:(F=o.etiquetas)!=null&&F.length?o.etiquetas.map(u=>e.jsx("li",{children:u.nombre},u.id)):e.jsx("li",{children:"No hay etiquetas disponibles."})})]})]}),e.jsx("div",{className:"product-mapa",children:e.jsx(de,{})}),e.jsxs("div",{className:"product-related",children:[e.jsx("h2",{className:"titulo",children:"Disfraces con las mismas etiquetas"}),e.jsx("div",{className:"productos-similares-container",children:e.jsx("div",{className:"productos-similares-lista",children:v.length?v.slice(0,6).map((u,h)=>e.jsxs("div",{className:"producto-similar",onClick:()=>C(u),children:[e.jsx(R,{imagenes:u.imagenes,alt:u.nombre,className:"d-block w-100"}),e.jsx("p",{children:u.nombre})]},h)):e.jsx("p",{children:"No existen disfraces que coincidan en etiquetas."})})}),e.jsx("h2",{className:"titulo",children:"Disfraces de los mismos eventos"}),e.jsx("div",{className:"productos-similares-container",children:e.jsx("div",{className:"productos-similares-lista",children:f.length?f.slice(0,6).map((u,h)=>e.jsxs("div",{className:"producto-similar",onClick:()=>C(u),children:[e.jsx(R,{imagenes:u.imagenes,alt:u.nombre,className:"d-block w-100"}),e.jsx("p",{children:u.nombre})]},h)):e.jsx("p",{children:"No existen disfraces que coincidan en eventos."})})}),e.jsx("h2",{className:"titulo",children:"Disfraces del mismo mes"}),e.jsx("div",{className:"productos-similares2-container",children:e.jsx("div",{className:"productos-similares-lista",children:x.length?x.slice(0,6).map((u,h)=>e.jsxs("div",{className:"producto-similar",onClick:()=>C(u),children:[e.jsx(R,{imagenes:u.imagenes,alt:u.nombre,className:"d-block w-100"}),e.jsx("p",{children:u.nombre})]},h)):e.jsx("p",{children:"No existen disfraces que coincidan en el mes."})})})]})]})},J=({children:s,tipo:a})=>{const c=a==="success"?"success":"error",m=a==="success"?Ne:we;return e.jsxs("div",{className:`mensaje-container ${c}`,children:[e.jsx(M,{icon:m,className:"mensaje-icon"}),e.jsx("div",{className:"mensaje-text",children:e.jsx("p",{children:s})})]})},Be=()=>{const[s,a]=n.useState({email:"",password:"",tipoUsuario:"usuario"}),[c,m]=n.useState({}),o=U(),i=b=>{a({...s,[b.target.name]:b.target.value})},l=async b=>{var d,t;b.preventDefault();try{const r=s.tipoUsuario==="admin"||s.tipoUsuario==="moderador"?"https://backend-mywf.onrender.com/api/admin/login":"https://backend-mywf.onrender.com/api/usuario/login",p=await $.post(r,s);if(p!=null&&p.data)m({respuesta:p.data.msg,tipo:!0}),p.data.token&&(localStorage.setItem("token",p.data.token),localStorage.setItem("tipoUsuario",p.data.rol),console.log("Rol guardado en localStorage:",p.data.rol),p.data.rol==="admin"||p.data.rol==="moderador"||p.data.rol==="usuario"?o("/"):m({respuesta:"Rol desconocido",tipo:!1})),a({email:"",password:"",tipoUsuario:"usuario"});else throw new Error("Respuesta inesperada del servidor")}catch(r){const p=((t=(d=r.response)==null?void 0:d.data)==null?void 0:t.msg)||"Error al iniciar sesión";m({respuesta:p,tipo:!1}),console.error("Error:",r.message)}};return e.jsxs("div",{className:"login-body",children:[e.jsx(A,{className:"brand",to:"/",children:e.jsxs("div",{className:"brand-content",children:[e.jsx("img",{src:"public/logo.png",alt:"Logo Megadisfraz",className:"header-logo-img"}),e.jsx("span",{className:"brand-text",children:"Megadisfraz"})]})}),e.jsxs("div",{className:"login-wrapper",children:[e.jsx("h2",{className:"text-center mb-4",children:"Iniciar sesión"}),e.jsxs("form",{id:"login-form",onSubmit:l,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"email",children:"Correo electrónico:"}),e.jsx("input",{type:"email",className:"form-control",id:"email",name:"email",value:s.email,onChange:i,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"password",children:"Contraseña:"}),e.jsx("input",{type:"password",className:"form-control",id:"password",name:"password",value:s.password,onChange:i,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Tipo de usuario:"}),e.jsxs("select",{name:"tipoUsuario",className:"form-control",onChange:i,value:s.tipoUsuario,children:[e.jsx("option",{value:"usuario",children:"Usuario"}),e.jsx("option",{value:"admin",children:"Administrador"}),e.jsx("option",{value:"moderador",children:"Moderador"})]})]}),e.jsx("p",{className:"forgot-password",children:e.jsx(A,{to:"/forgot/id",className:"forgot-link",children:"¿Olvidaste tu contraseña?"})}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Iniciar sesión"}),e.jsxs("p",{className:"text-center mt-3",children:["¿No tienes una cuenta?"," ",e.jsx(A,{to:"/register",className:"register-link",children:"Regístrate"})]})]}),c.respuesta&&e.jsx(J,{tipo:c.tipo?"success":"error",children:c.respuesta})]})]})},Oe=()=>{const[s,a]=n.useState({nombre:"",apellido:"",email:"",password:""}),[c,m]=n.useState({respuesta:"",tipo:""}),o=U(),i=b=>{a({...s,[b.target.name]:b.target.value})},l=async b=>{b.preventDefault();const d=/^[a-zA-ZáéíóúÁÉÍÓÚñÑ\s]+$/;if(!s.nombre.trim()||!s.apellido.trim()||!s.email.trim()||!s.password.trim()){m({respuesta:"Todos los campos son obligatorios.",tipo:"error"});return}if(!d.test(s.nombre)||!d.test(s.apellido)){m({respuesta:"El nombre y apellido solo pueden contener letras y espacios.",tipo:"error"});return}try{const r=await $.post("https://backend-mywf.onrender.com/api/usuario/registro",s);r&&r.data?(m({respuesta:r.data.msg,tipo:"success"}),setTimeout(()=>{m({respuesta:"",tipo:""}),o("/login")},3e3),a({nombre:"",apellido:"",email:"",password:""})):m({respuesta:"Algo salió mal",tipo:"error"})}catch(t){const r=t.response&&t.response.data?t.response.data.msg:"Error al registrar";m({respuesta:r,tipo:"error"})}};return e.jsxs("div",{className:"login-body",children:[e.jsx(A,{className:"brand",to:"/",children:e.jsxs("div",{className:"brand-content",children:[e.jsx("img",{src:"public/logo.png",alt:"Logo Megadisfraz",className:"header-logo-img"}),e.jsx("span",{className:"brand-text",children:"Megadisfraz"})]})}),e.jsxs("div",{className:"login-wrapper",children:[e.jsx("h2",{className:"text-center mb-4",children:"Registro"}),e.jsxs("form",{id:"login-form",onSubmit:l,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"nombre",children:"Nombre:"}),e.jsx("input",{type:"text",className:"form-control",id:"nombre",name:"nombre",value:s.nombre,onChange:i})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"apellido",children:"Apellido:"}),e.jsx("input",{type:"text",className:"form-control",id:"apellido",name:"apellido",value:s.apellido,onChange:i})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"email",children:"Correo Electrónico:"}),e.jsx("input",{type:"email",className:"form-control",id:"email",name:"email",value:s.email,onChange:i})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"password",children:"Contraseña:"}),e.jsx("input",{type:"password",className:"form-control",id:"password",name:"password",value:s.password,onChange:i})]}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Registrarse"}),e.jsxs("p",{className:"text-center mt-3",children:["¿Ya tienes una cuenta?"," ",e.jsx(A,{to:"/login",className:"login-link",children:"Inicia Sesión"})]})]}),c.respuesta&&e.jsx(J,{tipo:c.tipo,children:c.respuesta})]})]})},Je=()=>{const{token:s}=W(),[a,c]=n.useState({respuesta:"",tipo:null});return n.useEffect(()=>{(async()=>{var o,i;try{const l=`https://backend-mywf.onrender.com/api/usuario/confirmar/${s}`,b=await $.get(l);c({respuesta:b.data.msg,tipo:"success"})}catch(l){c({respuesta:((i=(o=l.response)==null?void 0:o.data)==null?void 0:i.msg)||"Error al confirmar cuenta",tipo:"error"})}})()},[s]),e.jsxs("div",{className:"login-body",children:[e.jsx(A,{className:"brand",to:"/",children:e.jsxs("div",{className:"brand-content",children:[e.jsx("img",{src:"public/logo.png",alt:"Logo Megadisfraz",className:"header-logo-img"}),e.jsx("span",{className:"brand-text",children:"Megadisfraz"})]})}),e.jsxs("div",{className:"login-wrapper",children:[e.jsx("h2",{className:"text-center mb-4",children:"Confirmación de Cuenta"}),a.respuesta&&e.jsx(J,{tipo:a.tipo,children:a.respuesta}),e.jsx("div",{className:"confirmar-circle",children:e.jsx(M,{icon:ye,className:"confirmar-icon"})}),e.jsx("p",{className:"text-center confirmar-texto-gracias",children:"¡Gracias por confirmar tu cuenta!"}),e.jsx("p",{className:"text-center confirmar-texto-iniciar",children:"Ahora puedes iniciar sesión."}),e.jsx(A,{to:"/login",className:"confirmar-link",children:"Iniciar Sesión"})]})]})},_e=()=>{const[s,a]=n.useState({}),[c,m]=n.useState({email:"",tipoUsuario:"usuario"}),o=l=>{m({...c,[l.target.name]:l.target.value})},i=async l=>{var b,d;l.preventDefault();try{const t=c.tipoUsuario==="admin"?"https://backend-mywf.onrender.com/api/admin/recuperar-password":"https://backend-mywf.onrender.com/api/usuario/recuperar-password",r=await $.post(t,{email:c.email});a({respuesta:r.data.msg,tipo:"success"}),m({email:"",tipoUsuario:"usuario"})}catch(t){a({respuesta:((d=(b=t.response)==null?void 0:b.data)==null?void 0:d.msg)||"Error al recuperar contraseña",tipo:"error"})}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"login-body",children:[e.jsx(A,{className:"brand",to:"/",children:e.jsxs("div",{className:"brand-content",children:[e.jsx("img",{src:"/logo.png",alt:"Logo Megadisfraz",className:"header-logo-img"}),e.jsx("span",{className:"brand-text",children:"Megadisfraz"})]})}),e.jsxs("div",{className:"login-wrapper",children:[s.respuesta&&e.jsx(J,{tipo:s.tipo,children:s.respuesta}),e.jsx("h1",{className:"text-center mb-4",children:"¡Olvidaste tu contraseña!"}),e.jsx("h3",{className:"text-center mb-4",children:"No te preocupes, ingresa tu correo"}),e.jsxs("form",{onSubmit:i,children:[e.jsxs("div",{className:"login-form-group",children:[e.jsx("label",{className:"mb-2 block text-sm font-semibold",children:"Email"}),e.jsx("input",{type:"email",placeholder:"Enter your email",className:"form-control",name:"email",value:c.email,onChange:o})]}),e.jsxs("div",{className:"login-form-group",children:[e.jsx("label",{className:"mb-2 block text-sm font-semibold",children:"Tipo de Usuario"}),e.jsxs("select",{className:"form-control",name:"tipoUsuario",value:c.tipoUsuario,onChange:o,children:[e.jsx("option",{value:"usuario",children:"Usuario"}),e.jsx("option",{value:"admin",children:"Administrador"})]})]}),e.jsx("div",{className:"mb-3",children:e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Enviar Correo"})})]}),e.jsxs("div",{className:"text-center mt-3",children:[e.jsx("p",{children:"Si la recuerdas"}),e.jsx(A,{to:"/login",className:"register-link",children:"Login"})]})]})]}),e.jsx("div",{className:"forgot-background"})]})},He=()=>{const{token:s}=W(),a=U(),[c,m]=n.useState(!1),[o,i]=n.useState({password:"",confirmpassword:""}),l=d=>{i({...o,[d.target.name]:d.target.value||""})},b=async d=>{d.preventDefault();try{const t=`https://backend-mywf.onrender.com/api/usuario/nuevo-password/${s}`,r=await $.post(t,o);i({password:"",confirmpassword:""}),O.success(r.data.msg),setTimeout(()=>{a("/login")},3e3)}catch(t){O.error(t.response.data.msg)}};return n.useEffect(()=>{(async()=>{try{const t=`https://backend-mywf.onrender.com/api/usuario/recuperar-password/${s}`,r=await $.get(t);m(!0),O.success(r.data.msg)}catch(t){O.error(t.response.data.msg)}})()},[s]),e.jsxs("div",{className:"login-body",children:[e.jsx(A,{className:"brand",to:"/",children:e.jsxs("div",{className:"brand-content",children:[e.jsx("img",{src:"public/logo.png",alt:"Logo Megadisfraz",className:"header-logo-img"}),e.jsx("span",{className:"brand-text",children:"Megadisfraz"})]})}),e.jsxs("div",{className:"login-wrapper",children:[e.jsx(Ee,{}),e.jsx("h1",{className:"text-center mb-4 text-3xl font-semibold uppercase text-gray-500",children:"Bienvenido Otra Vez"}),e.jsx("small",{className:"text-center text-gray-400 my-4 block text-sm",children:"Por favor ingresa los detalles"}),c&&e.jsxs("form",{className:"w-full",onSubmit:b,children:[e.jsxs("div",{className:"login-form-group",children:[e.jsx("label",{className:"mb-2 block text-sm font-semibold",children:"Password"}),e.jsx("input",{type:"password",placeholder:"Enter your password",className:"form-control",name:"password",value:o.password,onChange:l}),e.jsx("label",{className:"mb-2 block text-sm font-semibold",children:"Confirm Password"}),e.jsx("input",{type:"password",placeholder:"Repeat your password",className:"form-control",name:"confirmpassword",value:o.confirmpassword,onChange:l})]}),e.jsx("div",{className:"mb-3",children:e.jsx("button",{className:"btn btn-primary",children:"Enviar"})})]})]})]})},Ge=()=>{const s=U(),{auth:a,obtenerPerfil:c,actualizarPerfil:m,actualizarPassword:o}=n.useContext(me),[i,l]=n.useState({passwordactual:"",password:"",confirmpassword:""}),[b,d]=n.useState(""),[t,r]=n.useState(""),[p,y]=n.useState(""),N=a==null?void 0:a.rol;n.useEffect(()=>{const j=localStorage.getItem("token");j?c(j).then(x=>{r(x.nombre),y(x.apellido)}).catch(()=>{d("Error al cargar el perfil.")}):s("/")},[s]);const w=()=>{localStorage.removeItem("token"),localStorage.removeItem("tipoUsuario"),s("/")},v=j=>{l({...i,[j.target.name]:j.target.value})},g=async j=>{j.preventDefault();const x=/^[a-zA-ZáéíóúÁÉÍÓÚñÑ\s]+$/;if(!t.trim()||!p.trim()){d("El nombre y apellido no pueden estar vacíos.");return}if(!x.test(t)||!x.test(p)){d("El nombre y apellido solo pueden contener letras y espacios.");return}try{await m(a.usuario._id,{nombre:t,apellido:p}),d("Perfil actualizado con éxito."),setTimeout(()=>{s("/perfil")},1e3)}catch{d("Error al actualizar el perfil.")}},f=async j=>{if(j.preventDefault(),!i.passwordactual||!i.password||!i.confirmpassword){d("Todos los campos de contraseña son obligatorios.");return}if(i.password!==i.confirmpassword){d("Las contraseñas no coinciden.");return}try{await o({passwordactual:i.passwordactual,passwordnuevo:i.password}),d("Contraseña actualizada correctamente."),l({passwordactual:"",password:"",confirmpassword:""})}catch{d("Error al actualizar la contraseña.")}};return e.jsx("div",{className:"profile-container",children:e.jsxs("div",{className:"profile-wrapper",children:[e.jsx("h4",{className:"mb-4 text-center",children:N==="admin"?"Perfil de Administrador":"Perfil de Usuario"}),b&&e.jsx("div",{className:`alert ${b.includes("Error")?"alert-danger":"alert-success"}`,children:b}),a.usuario?e.jsxs("table",{className:"profile-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{class:"hidden-on-mobile",children:"ID de Usuario"}),e.jsx("th",{children:"Correo Electrónico"}),e.jsx("th",{children:"Nombre"}),e.jsx("th",{children:"Apellido"})]})}),e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{class:"hidden-on-mobile",children:a.usuario._id}),e.jsx("td",{children:a.usuario.email}),e.jsx("td",{children:a.usuario.nombre}),e.jsx("td",{children:a.usuario.apellido})]})})]}):e.jsx("p",{children:"Cargando..."}),e.jsxs("form",{onSubmit:g,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Nuevo Nombre"}),e.jsx("input",{type:"text",className:"profile-input",value:t,onChange:j=>r(j.target.value)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Nuevo Apellido"}),e.jsx("input",{type:"text",className:"profile-input",value:p,onChange:j=>y(j.target.value)})]}),e.jsx("button",{type:"submit",className:"btn btn-success profile-button",children:"Actualizar Perfil"})]}),e.jsxs("form",{onSubmit:f,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Contraseña Actual"}),e.jsx("input",{type:"password",placeholder:"Ingrese su contraseña actual",className:"profile-input",name:"passwordactual",value:i.passwordactual,onChange:v})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Nueva Contraseña"}),e.jsx("input",{type:"password",placeholder:"Ingrese su nueva contraseña",className:"profile-input",name:"password",value:i.password,onChange:v})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Confirmar Contraseña"}),e.jsx("input",{type:"password",placeholder:"Repita su nueva contraseña",className:"profile-input",name:"confirmpassword",value:i.confirmpassword,onChange:v})]}),e.jsx("button",{type:"submit",className:"btn btn-success profile-button",children:"Actualizar Contraseña"})]}),e.jsx("div",{className:"d-flex justify-content-between mt-3",children:e.jsx("button",{type:"button",className:"btn btn-danger profile-button",onClick:w,children:"Cerrar Sesión"})})]})})},Ye=()=>e.jsxs("div",{className:"not-found-container",children:[e.jsx("img",{src:"public/logo.png",alt:"Logo Megadisfraz",className:"header-logo-img"}),e.jsx("span",{className:"brand-text",children:"Megadisfraz"}),e.jsx("div",{className:"not-found-icon-wrapper",children:e.jsx(M,{icon:Ce,className:"not-found-icon"})}),e.jsx("div",{className:"not-found-content-wrapper",children:e.jsxs("div",{className:"not-found-content",children:[e.jsx("p",{className:"not-found-title",children:"Pagina no encontrada"}),e.jsx("p",{className:"not-found-text",children:"Lo sentimos, la pagina que buscas no se puedo encontrar"})]})})]}),We=()=>{const s=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],[a,c]=n.useState({mes:"",dia:"",nombre:"",descripcion:""}),[m,o]=n.useState([]),i=d=>{const t=["Abril","Junio","Septiembre","Noviembre"];return d==="Febrero"?Array.from({length:29},(r,p)=>p+1):t.includes(d)?Array.from({length:30},(r,p)=>p+1):Array.from({length:31},(r,p)=>p+1)};n.useEffect(()=>{a.mes&&(o(i(a.mes)),c(d=>({...d,dia:""})))},[a.mes]);const l=d=>{const{name:t,value:r}=d.target;c({...a,[t]:r})},b=async d=>{d.preventDefault();try{const t=await fetch("https://backend-mywf.onrender.com/api/festividad/crear",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({...a,dia:parseInt(a.dia,10)})});if(!t.ok)throw new Error("Error al crear el evento");await t.json(),alert("✅ Evento creado exitosamente")}catch{alert("❌ Hubo un problema al crear el evento")}};return e.jsxs("div",{className:"form-container",children:[e.jsx("h2",{className:"tittle-crearev",children:"Crear Eventos"}),e.jsxs("form",{onSubmit:b,className:"form-content",children:[e.jsxs("div",{className:"form-group1",children:[e.jsx("label",{htmlFor:"mes",children:"Mes:"}),e.jsxs("select",{id:"mes",name:"mes",className:"form-input3",value:a.mes,onChange:l,required:!0,children:[e.jsx("option",{value:"",children:"-- Selecciona un mes --"}),s.map((d,t)=>e.jsx("option",{value:d,children:d},t))]})]}),e.jsxs("div",{className:"form-group1",children:[e.jsx("label",{htmlFor:"dia",children:"Día:"}),e.jsxs("select",{id:"dia",name:"dia",className:"form-input3",value:a.dia,onChange:l,required:!0,disabled:!a.mes,children:[e.jsx("option",{value:"",children:"-- Selecciona un día --"}),m.map(d=>e.jsx("option",{value:d.toString(),children:d},d))]})]}),e.jsxs("div",{className:"form-group1",children:[e.jsx("label",{htmlFor:"nombre",children:"Nombre del evento o festividad:"}),e.jsx("input",{type:"text",id:"nombre",name:"nombre",className:"form-input3",value:a.nombre,onChange:l,required:!0})]}),e.jsxs("div",{className:"form-group1",children:[e.jsx("label",{htmlFor:"descripcion",children:"Descripción de la festividad:"}),e.jsx("textarea",{id:"descripcion",name:"descripcion",className:"form-input3",value:a.descripcion,onChange:l,required:!0})]}),e.jsx("button",{type:"submit",className:"form-button",children:"Crear"})]})]})},Qe=()=>{const s=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],[a,c]=n.useState([]),[m,o]=n.useState([]),[i,l]=n.useState({mes:"",dia:"",nombre:"",descripcion:""}),[b,d]=n.useState([]),[t,r]=n.useState(!1),[p,y]=n.useState(null),[N,w]=n.useState("");n.useEffect(()=>{(async()=>{try{const q=await(await fetch("https://backend-mywf.onrender.com/api/festividad/festividades",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).json();c(q),o(q)}catch(C){console.error("Error al cargar eventos:",C),alert("Error al cargar eventos")}})()},[]),n.useEffect(()=>{if(N.trim()==="")o(a);else{const x=a.filter(C=>C.nombre.toLowerCase().includes(N.toLowerCase())||C.mes.toLowerCase().includes(N.toLowerCase())||C.dia.toString().includes(N));o(x)}},[N,a]),n.useEffect(()=>{if(i.mes){const x=i.mes==="Febrero"?Array.from({length:29},(C,q)=>q+1):["Abril","Junio","Septiembre","Noviembre"].includes(i.mes)?Array.from({length:30},(C,q)=>q+1):Array.from({length:31},(C,q)=>q+1);d(x),l(C=>({...C,dia:""}))}},[i.mes]);const v=x=>{const C=a.find(q=>q.id===x);C&&(l(C),y(x),r(!0))},g=async x=>{if(confirm("¿Estás seguro de eliminar este evento?"))try{if(!(await fetch(`https://backend-mywf.onrender.com/api/festividad/eliminar/${x}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).ok)throw new Error;alert("✅ Evento eliminado");const q=a.filter(F=>F.id!==x);c(q),o(q)}catch{alert("❌ Error al eliminar evento")}},f=x=>{const{name:C,value:q}=x.target;l(F=>({...F,[C]:q}))},j=async x=>{x.preventDefault();try{if(!(await fetch(`https://backend-mywf.onrender.com/api/festividad/actualizar/${p}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({...i,dia:parseInt(i.dia,10)})})).ok)throw new Error;alert("✅ Evento actualizado correctamente");const q=a.map(F=>F.id===p?{...F,...i}:F);c(q),o(q),r(!1),y(null)}catch{alert("❌ Error al actualizar el evento")}};return e.jsx("div",{className:"form-container",children:t?e.jsxs("form",{onSubmit:j,className:"form-content",children:[e.jsx("h2",{className:"admin-title",children:"Editar Festividad"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"nombre",children:"Nombre del evento:"}),e.jsx("input",{type:"text",id:"nombre",name:"nombre",className:"form-input",value:i.nombre,onChange:f,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"mes",children:"Mes:"}),e.jsxs("select",{id:"mes",name:"mes",className:"form-input",value:i.mes,onChange:f,required:!0,children:[e.jsx("option",{value:"",children:"-- Selecciona un mes --"}),s.map((x,C)=>e.jsx("option",{value:x,children:x},C))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"dia",children:"Día:"}),e.jsxs("select",{id:"dia",name:"dia",className:"form-input",value:i.dia,onChange:f,disabled:!i.mes,required:!0,children:[e.jsx("option",{value:"",children:"-- Selecciona un día --"}),b.map(x=>e.jsx("option",{value:x,children:x},x))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"descripcion",children:"Descripción:"}),e.jsx("textarea",{id:"descripcion",name:"descripcion",className:"form-input",value:i.descripcion,onChange:f,required:!0,maxLength:250}),e.jsxs("p",{className:i.descripcion.length>=250?"text-error":"",children:[i.descripcion.length," / 250 caracteres"]})]}),e.jsx("button",{type:"submit",className:"form-button",children:"Guardar Cambios"}),e.jsx("button",{type:"button",className:"cancel-button",onClick:()=>r(!1),children:"Cancelar"})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"admin-title",children:"Lista de Festividades"}),e.jsxs("div",{className:"form-content",children:[e.jsx("label",{htmlFor:"busqueda",children:"Buscar por Nombre, Mes o Día:"}),e.jsx("input",{type:"text",id:"busqueda",name:"busqueda",className:"form-input",value:N,onChange:x=>w(x.target.value),placeholder:"Ingrese un nombre, mes o día"})]}),e.jsx("ul",{className:"disfraz-list",children:m.map(x=>e.jsxs("li",{className:"disfraz-item",children:[e.jsxs("div",{className:"disfraz-info",children:[e.jsx("strong",{children:x.nombre})," - ",x.mes,"/",x.dia,e.jsx("br",{}),e.jsx("small",{children:x.descripcion})]}),e.jsxs("div",{className:"disfraz-actions",children:[e.jsx("button",{className:"edit-button2",onClick:()=>v(x.id),children:"Actualizar"}),e.jsx("button",{className:"delete-button2",onClick:()=>g(x.id),children:"Eliminar"})]})]},x.id))})]})})},Xe=()=>{const[s,a]=n.useState(null);return e.jsxs("div",{className:"admin-container",children:[e.jsx("h1",{className:"admin-title",children:"Gestión de Eventos"}),e.jsxs("div",{className:"admin-buttons-container",children:[e.jsx("button",{className:"admin-button button-crear",onClick:()=>a("crear"),children:"Crear Evento"}),e.jsx("button",{className:"admin-button button-actualizar",onClick:()=>a("editar"),children:"Editar Evento"})]}),e.jsxs("div",{className:"admin-module-container",style:{marginTop:"20px"},children:[s==="crear"&&e.jsx(We,{}),s==="editar"&&e.jsx(Qe,{})]})]})},Ze=()=>{const s=ne(),a=U(),{disfraces:c=[]}=n.useContext(B),[m,o]=n.useState(""),[i,l]=n.useState(""),[b,d]=n.useState(""),[t,r]=n.useState(""),p=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],y=f=>f?f.replace(/\|/g,"").trim():"";n.useEffect(()=>{const f=new URLSearchParams(s.search);o(f.get("query")||""),l(y(f.get("month")||"")),d(f.get("etiqueta")||""),r(f.get("event")||"")},[s]);const N=c.filter(f=>{var F,u,h,E;const j=m.toLowerCase(),x=i.toLowerCase(),C=b.toLowerCase(),q=t.toLowerCase();return(!m||f.nombre.toLowerCase().includes(j)||((F=f.descripcion)==null?void 0:F.toLowerCase().includes(j)))&&(!i||((u=f.festividades)==null?void 0:u.some(z=>z.mes.toLowerCase()===x)))&&(!b||((h=f.etiquetas)==null?void 0:h.some(z=>z.nombre.toLowerCase()===C)))&&(!t||((E=f.festividades)==null?void 0:E.some(z=>z.nombre.toLowerCase().includes(q))))}),v=(f=>{if(!f.length)return[];const j=p[new Date().getMonth()],x=p.indexOf(j),C=[...p.slice(x),...p.slice(0,x)].reverse();return[...f].sort((q,F)=>{const u=h=>{var z;let E=-1;return(z=h.festividades)==null||z.forEach(S=>{const k=C.indexOf(S.mes);k>E&&(E=k)}),E};return u(F)-u(q)})})(N),g=f=>a(`/productos/${f.id}`);return e.jsx("div",{className:"searches-container",children:e.jsxs("section",{className:"filtered-disfraces",children:[e.jsxs("h2",{className:"filtered-title",children:[m&&`Resultados para "${m}" `,i&&` Disfraces de ${i} `,b&&` Etiqueta: ${b} `,t&&` Evento: ${t}`]}),e.jsx("div",{className:"filtered-container",children:v.length?v.map(f=>{var j;return e.jsxs(G,{className:"filtered-card",onClick:()=>g(f),children:[e.jsx(R,{imagenes:f.imagenes,alt:f.nombre,className:"filtered-image"}),e.jsxs(Y,{children:[e.jsx("p",{children:f.nombre}),((j=f.festividades)==null?void 0:j.length)>0&&e.jsxs("small",{children:["Festividades: ",f.festividades.map(x=>x.mes).join(", ")]})]})]},f.id)}):e.jsx("p",{className:"no-disfraces",children:"No se encontraron disfraces con los filtros aplicados"})})]})})},Ke=()=>{const[s,a]=n.useState({nombre:"",etiquetas:[],festividades:[],descripcion:"",imagenes:[]}),[c,m]=n.useState([]),[o,i]=n.useState([]),[l,b]=n.useState(!0),[d,t]=n.useState(null),[r,p]=n.useState(!1),y=u=>{const h=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];return[...u].sort((E,z)=>{const S=h.indexOf(E.mes),k=h.indexOf(z.mes);return S!==k?S-k:E.dia-z.dia})},N=u=>[...u].sort((h,E)=>h.nombre.localeCompare(E.nombre));n.useEffect(()=>{(async()=>{try{const[h,E]=await Promise.all([fetch("https://backend-mywf.onrender.com/api/festividad/festividades",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),fetch("https://backend-mywf.onrender.com/api/etiqueta/listar",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})]);if(!h.ok||!E.ok)throw new Error("Error al cargar datos iniciales");const[z,S]=await Promise.all([h.json(),E.json()]);m(y(z||[])),i(N(S||[])),b(!1)}catch(h){console.error("Error al cargar datos:",h),t("Hubo un problema al cargar los datos necesarios"),b(!1)}})()},[]);const w=u=>{const{name:h,value:E}=u.target;a(z=>({...z,[h]:E}))},v=u=>{const h=parseInt(u.target.value);if(h===-1){window.location.href="/etiquetas";return}s.etiquetas.includes(h)||(s.etiquetas.length<6?a(E=>({...E,etiquetas:[...E.etiquetas,h]})):alert("❌ Máximo 6 etiquetas permitidas"))},g=u=>{a(h=>({...h,etiquetas:h.etiquetas.filter(E=>E!==u)}))},f=u=>{const h=parseInt(u.target.value);if(h===-1){window.location.href="/eventos";return}s.festividades.includes(h)||(s.festividades.length<5?a(E=>({...E,festividades:[...E.festividades,h]})):alert("❌ Máximo 5 festividades permitidas"))},j=u=>{a(h=>({...h,festividades:h.festividades.filter(E=>E!==u)}))},x=u=>{const h=Array.from(u.target.files);if(h.length+s.imagenes.length>3){alert("❌ Solo puedes subir un máximo de 3 imágenes");return}const E=h.map(z=>new Promise(S=>{const k=new FileReader;k.onloadend=()=>{S({file:z,preview:k.result})},k.readAsDataURL(z)}));Promise.all(E).then(z=>{a(S=>({...S,imagenes:[...S.imagenes,...z]}))})},C=u=>{a(h=>{const E=[...h.imagenes];return E.splice(u,1),{...h,imagenes:E}})},q=async()=>{try{const u=s.imagenes.map(async h=>{const E=new FormData;E.append("file",h.file),E.append("upload_preset","megadisfraz");const z=await fetch("https://api.cloudinary.com/v1_1/dxnnwuzrl/image/upload",{method:"POST",body:E});if(!z.ok){const S=await z.json();throw new Error(S.message||"Error al subir imagen")}return z.json()});return await Promise.all(u)}catch(u){throw console.error("Error al subir imágenes:",u),u}},F=async u=>{if(u.preventDefault(),p(!0),s.imagenes.length===0){alert("❌ Debes subir al menos una imagen"),p(!1);return}if(s.festividades.length===0){alert("❌ Debes seleccionar al menos una festividad"),p(!1);return}try{const E=(await q()).map(D=>D.secure_url),z={nombre:s.nombre.trim(),descripcion:s.descripcion.trim(),festividades:s.festividades,etiquetas:s.etiquetas,imagenes:E},S=await fetch("https://backend-mywf.onrender.com/api/disfraz/registro",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(z)}),k=await S.json();if(!S.ok)throw new Error(k.msg||"Error al crear el disfraz");alert("✅ Disfraz creado exitosamente"),a({nombre:"",etiquetas:[],festividades:[],descripcion:"",imagenes:[]})}catch(h){console.error("Error completo:",h),alert(h.message||"Hubo un problema al crear el disfraz")}finally{p(!1)}};return l?e.jsxs("div",{className:"form-container",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Cargando datos necesarios..."})]}):d?e.jsxs("div",{className:"form-container",children:[e.jsx("p",{className:"error-message",children:d}),e.jsx("button",{className:"form-button",onClick:()=>window.location.reload(),children:"Reintentar"})]}):e.jsx("div",{className:"form-container",children:e.jsxs("form",{onSubmit:F,className:"form-content",children:[e.jsx("h2",{children:"Crear Disfraz"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"nombre",children:"Nombre:"}),e.jsx("input",{type:"text",id:"nombre",name:"nombre",className:"form-input",value:s.nombre,onChange:w,required:!0,maxLength:100})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"etiquetas",children:"Etiquetas (máx. 6):"}),e.jsxs("select",{id:"etiquetas",name:"etiquetas",className:"form-input1",onChange:v,value:"",children:[e.jsx("option",{value:"",children:"Seleccione una etiqueta"}),o.map(u=>e.jsx("option",{value:u.id,children:u.nombre},u.id)),e.jsx("option",{value:"-1",children:"➕ Crear nueva etiqueta"})]}),e.jsx("ul",{className:"etiquetas-list",children:s.etiquetas.map(u=>{const h=o.find(E=>E.id===u);return e.jsxs("li",{children:[(h==null?void 0:h.nombre)||"Etiqueta desconocida",e.jsx("button",{type:"button",className:"remove-button",onClick:()=>g(u),children:"X"})]},u)})}),e.jsxs("p",{className:s.etiquetas.length>=6?"text-error":"",children:[s.etiquetas.length," / 6 etiquetas seleccionadas"]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"festividad",children:"Festividades (máx. 5):"}),e.jsxs("select",{id:"festividad",name:"festividad",className:"form-input1",onChange:f,value:"",children:[e.jsx("option",{value:"",children:"Seleccione una festividad"}),c.map(u=>e.jsxs("option",{value:u.id,children:[u.nombre," - ",u.mes,"/",u.dia]},u.id)),e.jsx("option",{value:"-1",children:"➕ Crear nueva festividad"})]}),e.jsx("ul",{className:"festividades-list",children:s.festividades.map(u=>{const h=c.find(E=>E.id===u);return e.jsxs("li",{children:[(h==null?void 0:h.nombre)||"Festividad desconocida",e.jsx("button",{type:"button",className:"remove-button",onClick:()=>j(u),children:"X"})]},u)})}),e.jsxs("p",{className:s.festividades.length>=5?"text-error":"",children:[s.festividades.length," / 5 festividades seleccionadas"]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"descripcion",children:"Descripción (máx. 250 caracteres):"}),e.jsx("textarea",{id:"descripcion",name:"descripcion",className:"form-input1",maxLength:250,value:s.descripcion,onChange:w,required:!0}),e.jsxs("p",{className:s.descripcion.length>=250?"text-error":"",children:[s.descripcion.length," / 250 caracteres",s.descripcion.length>=250&&" (Límite alcanzado)"]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Imágenes (máximo 3):"}),e.jsxs("div",{className:"image-preview-container",children:[s.imagenes.map((u,h)=>e.jsxs("div",{className:"image-box",children:[e.jsx("img",{src:u.preview,alt:`Preview ${h}`,className:"preview-img"}),e.jsx("button",{type:"button",className:"remove-button",onClick:()=>C(h),"aria-label":"Eliminar imagen",children:"X"})]},h)),s.imagenes.length<3&&e.jsxs("div",{className:"image-box upload-box",children:[e.jsxs("label",{className:"add-image-label",children:["+",e.jsx("input",{type:"file",accept:"image/*",onChange:x,hidden:!0,multiple:!0,"aria-label":"Añadir imagen"})]}),e.jsx("p",{className:"add-image-text",children:"Añadir imagen"})]})]})]}),e.jsx("button",{type:"submit",className:"form-button",disabled:r,children:r?"Creando...":"Crear Disfraz"})]})})};function Ve(s){const[a,c]=n.useState([]),[m,o]=n.useState([]),[i,l]=n.useState([]),[b,d]=n.useState([]),[t,r]=n.useState(!0),[p,y]=n.useState(null);n.useEffect(()=>{(async()=>{try{r(!0);const[g,f,j]=await Promise.all([fetch("https://backend-mywf.onrender.com/api/disfraz/listar",{headers:{Authorization:`Bearer ${s}`}}),fetch("https://backend-mywf.onrender.com/api/etiqueta/listar",{headers:{Authorization:`Bearer ${s}`}}),fetch("https://backend-mywf.onrender.com/api/festividad/festividades",{headers:{Authorization:`Bearer ${s}`}})]);if(!g.ok||!f.ok||!j.ok)throw new Error("Error al cargar listas iniciales");const[x,C,q]=await Promise.all([g.json(),f.json(),j.json()]);c(x),o(x),l(C),d(q)}catch(g){console.error("useDisfraces:",g),y(g)}finally{r(!1)}})()},[s]);const N=n.useCallback(g=>{if(!g.trim()){o(a);return}const f=g.toLowerCase();o(a.filter(j=>{var x,C;return j.nombre.toLowerCase().includes(f)||((x=j.etiquetas)==null?void 0:x.some(q=>q.nombre.toLowerCase().includes(f)))||((C=j.festividades)==null?void 0:C.some(q=>q.nombre.toLowerCase().includes(f)))}))},[a]),w=n.useCallback(async g=>{const f=await fetch(`https://backend-mywf.onrender.com/api/disfraz/detalle/${g}`,{headers:{Authorization:`Bearer ${s}`}});if(!f.ok)throw new Error(`Detalle error: ${f.status}`);const j=await f.json();return j.imagenes=Q(j.imagenes),j},[s]),v=n.useCallback(async g=>{const f=await fetch(`https://backend-mywf.onrender.com/api/disfraz/eliminar/${g}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}});if(!f.ok)throw new Error(`Eliminar error: ${f.status}`);c(j=>j.filter(x=>x.id!==g)),o(j=>j.filter(x=>x.id!==g))},[s]);return{disfraces:m,etiquetas:i,eventos:b,loading:t,error:p,filtrar:N,fetchDetalle:w,eliminar:v,orig:a}}function es({value:s,onChange:a}){return e.jsxs("div",{className:"form-content",children:[e.jsx("label",{children:"Buscar:"}),e.jsx("input",{className:"form-input",placeholder:"Nombre, etiqueta o festividad",value:s,onChange:c=>a(c.target.value)})]})}function ss({items:s,onEdit:a,onDelete:c}){return e.jsx("ul",{className:"disfraz-list",children:s.map(m=>{var o,i;return e.jsxs("li",{className:"disfraz-item",children:[e.jsxs("div",{className:"disfraz-info",children:[e.jsx("strong",{children:"Nombre:"})," ",m.nombre,e.jsx("br",{}),e.jsx("strong",{children:"Etiquetas:"})," ",(o=m.etiquetas)==null?void 0:o.map(l=>l.nombre).join(", "),e.jsx("br",{}),e.jsx("strong",{children:"Festividades:"})," ",(i=m.festividades)==null?void 0:i.map(l=>l.nombre).join(", ")]}),e.jsxs("div",{className:"disfraz-actions",children:[e.jsx("button",{className:"edit-button2",onClick:()=>a(m.id),children:"Editar"}),e.jsx("button",{className:"delete-button2",onClick:()=>c(m.id),children:"Eliminar"})]})]},m.id)})})}function as({src:s,onRemove:a}){return e.jsxs("div",{className:"image-box",children:[e.jsx("img",{src:s,alt:"",className:"preview-img"}),e.jsx("button",{type:"button",className:"remove-button",onClick:a,children:"×"})]})}function rs({data:s,etiquetas:a,eventos:c,onChange:m,onEtiquetaAdd:o,onEtiquetaRemove:i,onFestAdd:l,onFestRemove:b,onFileAdd:d,onFileRemove:t,onSubmit:r,submitting:p,onCancel:y}){return e.jsxs("div",{className:"modal-container",children:[e.jsx("h2",{className:"modal-title",children:"Editar Disfraz"}),e.jsxs("form",{onSubmit:r,className:"form-content",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"nombre",className:"form-label",children:"Nombre:"}),e.jsx("input",{id:"nombre",name:"nombre",className:"form-input",value:s.nombre,onChange:m,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"descripcion",className:"form-label",children:"Descripción (máx. 250):"}),e.jsx("textarea",{id:"descripcion",name:"descripcion",className:"form-input1",maxLength:250,value:s.descripcion,onChange:m}),e.jsxs("p",{className:s.descripcion.length>=250?"text-error":"form-help",children:[s.descripcion.length," / 250"]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Etiquetas (máx. 6):"}),e.jsxs("select",{className:"form-input1",onChange:N=>o(+N.target.value),value:"",children:[e.jsx("option",{value:"",children:"Seleccione una etiqueta"}),a.map(N=>e.jsx("option",{value:N.id,children:N.nombre},N.id)),e.jsx("option",{value:-1,children:"➕ Crear nueva"})]}),e.jsx("ul",{className:"etiquetas-list",children:s.etiquetas.map(N=>{const w=a.find(v=>v.id===N);return e.jsxs("li",{className:"tag-item",children:[w==null?void 0:w.nombre,e.jsx("button",{type:"button",className:"remove-button",onClick:()=>i(N),children:"×"})]},N)})}),e.jsxs("p",{className:"form-help",children:[s.etiquetas.length," / 6 seleccionadas"]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Festividades (máx. 5):"}),e.jsxs("select",{className:"form-input1",onChange:N=>l(+N.target.value),value:"",children:[e.jsx("option",{value:"",children:"Seleccione una festividad"}),c.map(N=>e.jsx("option",{value:N.id,children:N.nombre},N.id)),e.jsx("option",{value:-1,children:"➕ Crear nueva"})]}),e.jsx("ul",{className:"festividades-list",children:s.festividades.map(N=>{const w=c.find(v=>v.id===N);return e.jsxs("li",{className:"tag-item",children:[w==null?void 0:w.nombre,e.jsx("button",{type:"button",className:"remove-button",onClick:()=>b(N),children:"×"})]},N)})}),e.jsxs("p",{className:"form-help",children:[s.festividades.length," / 5 seleccionadas"]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Imágenes (máx. 3):"}),e.jsxs("div",{className:"image-preview-container",children:[s.imagenes.map((N,w)=>e.jsx(as,{src:N.preview||N.url,onRemove:()=>t(w)},w)),s.imagenes.length<3&&e.jsxs("label",{className:"image-box upload-box",children:[e.jsx("span",{className:"add-image-label",children:"+"}),e.jsx("span",{className:"add-image-text",children:"Añadir imagen"}),e.jsx("input",{type:"file",accept:"image/*",hidden:!0,multiple:!0,onChange:d})]})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"submit",className:"form-button",disabled:p,children:p?"Actualizando...":"Guardar Cambios"}),e.jsx("button",{type:"button",className:"cancel-button",onClick:y,children:"Cancelar"})]})]})]})}function ts(){const s=localStorage.getItem("token"),{disfraces:a,etiquetas:c,eventos:m,loading:o,error:i,filtrar:l,fetchDetalle:b,eliminar:d}=Ve(s),[t,r]=n.useState({nombre:"",descripcion:"",etiquetas:[],festividades:[],imagenes:[]}),[p,y]=n.useState(!1),[N,w]=n.useState(null),[v,g]=n.useState(!1),f=async S=>{try{const k=await b(S);r({nombre:k.nombre,descripcion:k.descripcion||"",etiquetas:(k.etiquetas||[]).map(D=>D.id),festividades:(k.festividades||[]).map(D=>D.id),imagenes:k.imagenes.map(D=>({url:D,preview:D}))}),w(S),y(!0)}catch{alert("Error al cargar detalles del disfraz")}},j=()=>{y(!1),r({nombre:"",descripcion:"",etiquetas:[],festividades:[],imagenes:[]}),w(null)},x=S=>{const{name:k,value:D}=S.target;r(P=>({...P,[k]:D}))},C=S=>{if(S===-1)return window.location.href="/admin/etiquetas/crear";r(k=>k.etiquetas.includes(S)||k.etiquetas.length>=6?k:{...k,etiquetas:[...k.etiquetas,S]})},q=S=>{r(k=>({...k,etiquetas:k.etiquetas.filter(D=>D!==S)}))},F=S=>{if(S===-1)return window.location.href="/admin/festividades/crear";r(k=>k.festividades.includes(S)||k.festividades.length>=5?k:{...k,festividades:[...k.festividades,S]})},u=S=>{r(k=>({...k,festividades:k.festividades.filter(D=>D!==S)}))},h=S=>{const D=Array.from(S.target.files).slice(0,3-t.imagenes.length).map(P=>({file:P,preview:URL.createObjectURL(P)}));r(P=>({...P,imagenes:[...P.imagenes,...D]}))},E=S=>{r(k=>({...k,imagenes:k.imagenes.filter((D,P)=>P!==S)}))},z=async S=>{S.preventDefault(),g(!0);try{const k=t.imagenes.filter(L=>L.url).map(L=>L.url),D=t.imagenes.filter(L=>L.file).map(L=>L.file);let P=[];if(D.length>0){const L="megadisfraz",ue="dxnnwuzrl";P=await Promise.all(D.map(async he=>{const _=new FormData;return _.append("file",he),_.append("upload_preset",L),(await(await fetch(`https://api.cloudinary.com/v1_1/${ue}/image/upload`,{method:"POST",body:_})).json()).secure_url}))}const X={nombre:t.nombre,descripcion:t.descripcion,etiquetas:t.etiquetas,festividades:t.festividades,imagenes:[...k,...P]};console.log("Enviando JSON:",X);const Z=await fetch(`https://backend-mywf.onrender.com/api/disfraz/actualizar/${N}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(X)});if(!Z.ok){const L=await Z.json().catch(()=>({msg:"Error desconocido"}));throw new Error(L.msg)}alert("✅ Disfraz actualizado correctamente"),window.location.reload()}catch(k){console.error("❌ Error al actualizar disfraz:",k),alert("❌ "+k.message)}finally{g(!1)}};return o?e.jsx("div",{children:"Cargando disfraces…"}):i?e.jsxs("div",{children:["Error: ",i.message||"Desconocido"]}):e.jsx("div",{className:"form-container",children:p?e.jsx(rs,{data:t,etiquetas:c,eventos:m,onChange:x,onEtiquetaAdd:C,onEtiquetaRemove:q,onFestAdd:F,onFestRemove:u,onFileAdd:h,onFileRemove:E,onSubmit:z,submitting:v,onCancel:j}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"titlelistDis",children:"Lista de Disfraces"}),e.jsx(es,{onChange:l}),e.jsx(ss,{items:a,onEdit:f,onDelete:d})]})})}const ns=()=>{const[s,a]=n.useState(null);return e.jsxs("div",{className:"admin-container",children:[e.jsx("h1",{className:"admin-title",children:"Gestión de Disfraces"}),e.jsxs("div",{className:"admin-buttons-container",children:[e.jsx("button",{className:"admin-button button-crear",onClick:()=>a("crear"),children:"Crear Disfraz"}),e.jsx("button",{className:"admin-button button-actualizar",onClick:()=>a("editar"),children:"Editar Disfraz"})]}),e.jsxs("div",{className:"admin-module-container",style:{marginTop:"20px"},children:[s==="crear"&&e.jsx(Ke,{}),s==="editar"&&e.jsx(ts,{})]})]})},os=()=>{const[s,a]=n.useState({nombre:"",apellido:"",direccion:"",telefono:"",email:"",password:"",rol:"moderador"}),[c,m]=n.useState(""),o=l=>{const{name:b,value:d}=l.target;a({...s,[b]:d})},i=async l=>{l.preventDefault();try{const b=await fetch("https://backend-mywf.onrender.com/api/admin/crear-moderador",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(s)}),d=await b.json();if(!b.ok)throw new Error(d.msg||"Error al crear administrador");m("✅ Administrador creado correctamente"),a({nombre:"",apellido:"",direccion:"",telefono:"",email:"",password:"",rol:"moderador"})}catch(b){m(`❌ ${b.message}`)}};return e.jsx("div",{className:"form-container",children:e.jsxs("form",{onSubmit:i,className:"form-content",children:[e.jsx("h2",{children:"Crear Administrador"}),c&&e.jsx("p",{className:"mensaje",children:c}),["nombre","apellido","direccion","telefono","email","password"].map(l=>e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{htmlFor:l,children:[l.charAt(0).toUpperCase()+l.slice(1),":"]}),e.jsx("input",{type:l==="password"?"password":l==="email"?"email":"text",id:l,name:l,className:"form-input",value:s[l],onChange:o,required:!0})]},l)),e.jsx("button",{type:"submit",className:"form-button",children:"Crear"})]})})},is=()=>{const[s,a]=n.useState([]),[c,m]=n.useState([]),[o,i]=n.useState(null),[l,b]=n.useState({nombre:"",apellido:"",direccion:"",telefono:"",email:"",contraseña:""}),[d,t]=n.useState("");n.useEffect(()=>{(async()=>{try{const v=await fetch("https://backend-mywf.onrender.com/api/admin/listar-moderadores",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!v.ok)throw new Error("Error al obtener la lista de administradores");const g=await v.json();a(g),m(g)}catch(v){console.error("Error al cargar los administradores:",v),alert("Hubo un problema al cargar los administradores")}})()},[]),n.useEffect(()=>{if(d.trim()==="")m(s);else{const w=s.filter(v=>v.email.toLowerCase().includes(d.toLowerCase()));m(w)}},[d,s]);const r=async w=>{try{const v=await fetch(`https://backend-mywf.onrender.com/api/admin/detalle-moderador/${w}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!v.ok)throw new Error("Error al obtener los detalles del administrador");const g=await v.json();b(g),i(w)}catch(v){console.error("Error al cargar los detalles del administrador:",v),alert("Hubo un problema al cargar los detalles del administrador")}},p=async w=>{if(window.confirm("¿Estás seguro de que deseas eliminar este administrador?"))try{if(!(await fetch(`https://backend-mywf.onrender.com/api/admin/eliminar-moderador/${w}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).ok)throw new Error("Error al eliminar el administrador");alert("Administrador eliminado exitosamente");const f=s.filter(j=>j.id!==w);a(f),m(f),t("")}catch(g){console.error("Error al eliminar el administrador:",g),alert("Hubo un problema al eliminar el administrador")}},y=w=>{const{name:v,value:g}=w.target;b({...l,[v]:g})},N=async w=>{w.preventDefault();try{const v=await fetch(`https://backend-mywf.onrender.com/api/admin/actualizar-moderador/${o}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(l)});if(!v.ok)throw new Error("Error al actualizar el administrador");const g=await v.json();alert("Administrador actualizado exitosamente"),console.log("Administrador actualizado:",g),a(f=>f.map(j=>j.id===o?{...j,...l}:j)),m(f=>f.map(j=>j.id===o?{...j,...l}:j)),i(null)}catch(v){console.error("Error al actualizar el administrador:",v),alert("Hubo un problema al actualizar el administrador")}};return e.jsxs("div",{className:"form-container",children:[e.jsx("h2",{className:"listadmin",children:"Lista de Administradores"}),e.jsxs("div",{className:"form-content",children:[e.jsx("label",{className:"titlebusc",htmlFor:"email",children:"Buscar por Correo Electrónico:"}),e.jsx("input",{type:"email",id:"email",name:"email",className:"form-input",value:d,onChange:w=>t(w.target.value),placeholder:"Ingrese un correo electrónico"})]}),e.jsx("ul",{className:"admin-list",children:c.map(w=>e.jsxs("li",{className:"admin-item",children:[e.jsx("strong",{children:"Nombre:"})," ",w.nombre," ",w.apellido," ",e.jsx("br",{}),e.jsx("strong",{children:"Email:"})," ",w.email," ",e.jsx("br",{}),e.jsx("button",{onClick:()=>r(w.id),className:"edit-button",children:"Editar"}),e.jsx("button",{onClick:()=>p(w.id),className:"delete-button",children:"Eliminar"}),e.jsx("hr",{})]},w.id))}),o&&e.jsxs("form",{onSubmit:N,className:"form-content",children:[e.jsx("h2",{children:"Actualizar Administrador"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"nombre",children:"Nombre:"}),e.jsx("input",{type:"text",id:"nombre",name:"nombre",className:"form-input",value:l.nombre,onChange:y,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"apellido",children:"Apellido:"}),e.jsx("input",{type:"text",id:"apellido",name:"apellido",className:"form-input",value:l.apellido,onChange:y,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"direccion",children:"Dirección:"}),e.jsx("input",{type:"text",id:"direccion",name:"direccion",className:"form-input",value:l.direccion,onChange:y,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"telefono",children:"Teléfono:"}),e.jsx("input",{type:"tel",id:"telefono",name:"telefono",className:"form-input",value:l.telefono,onChange:y,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"email",children:"Email:"}),e.jsx("input",{type:"email",id:"email",name:"email",className:"form-input",value:l.email,onChange:y,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"contraseña",children:"Contraseña:"}),e.jsx("input",{type:"password",id:"contraseña",name:"contraseña",className:"form-input",value:l.contraseña,onChange:y,required:!0})]}),e.jsx("button",{type:"submit",className:"form-button",children:"Actualizar"})]})]})},ls=()=>{const[s,a]=n.useState(null);return e.jsxs("div",{className:"admin-container",children:[e.jsx("h1",{className:"admin-title",children:"Gestión de Administradores"}),e.jsxs("div",{className:"admin-buttons-container",children:[e.jsx("button",{className:"admin-button button-crear",onClick:()=>a("crear"),children:"Crear Administrador"}),e.jsx("button",{className:"admin-button button-actualizar",onClick:()=>a("actualizar"),children:"Actualizar Administrador"})]}),e.jsxs("div",{className:"admin-module-container",children:[s==="crear"&&e.jsx(os,{}),s==="actualizar"&&e.jsx(is,{})]})]})},cs=()=>{const[s,a]=n.useState({nombre:"",descripcion:""}),c=o=>{const{name:i,value:l}=o.target;a({...s,[i]:l})},m=async o=>{o.preventDefault();try{const i=await fetch("https://backend-mywf.onrender.com/api/etiqueta/crear",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(s)});if(!i.ok)throw new Error("Error al crear la etiqueta");const l=await i.json();alert("✅ Etiqueta creada exitosamente"),console.log("Etiqueta creada:",l),a({nombre:"",descripcion:""})}catch(i){console.error("Error al crear la etiqueta:",i),alert("❌ Hubo un problema al crear la etiqueta")}};return e.jsxs("div",{className:"form-container",children:[e.jsx("h2",{className:"title-crear-etiquetas",children:"Crear Etiqueta"}),e.jsxs("form",{onSubmit:m,className:"form-content",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"nombre",children:"Nombre:"}),e.jsx("input",{type:"text",id:"nombre",name:"nombre",className:"form-input",value:s.nombre,onChange:c,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"descripcion",children:"Descripción:"}),e.jsx("textarea",{id:"descripcion",name:"descripcion",className:"form-input",value:s.descripcion,onChange:c,required:!0})]}),e.jsx("button",{type:"submit",className:"form-button",children:"Crear"})]})]})},ds=()=>{const[s,a]=n.useState([]),[c,m]=n.useState([]),[o,i]=n.useState(""),[l,b]=n.useState(!1),[d,t]=n.useState({nombre:"",descripcion:""}),[r,p]=n.useState("");n.useEffect(()=>{(async()=>{try{const j=await(await fetch("https://backend-mywf.onrender.com/api/etiqueta/listar",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).json();a(j),m(j)}catch(f){console.error("Error al cargar etiquetas:",f),alert("Error al cargar etiquetas")}})()},[]),n.useEffect(()=>{if(r.trim()==="")m(s);else{const g=s.filter(f=>f.nombre.toLowerCase().includes(r.toLowerCase()));m(g)}},[r,s]);const y=g=>{const f=s.find(j=>j.id===g);f&&(i(g),t({nombre:f.nombre,descripcion:f.descripcion}),b(!0))},N=g=>{const{name:f,value:j}=g.target;t({...d,[f]:j})},w=async g=>{g.preventDefault();try{if(!(await fetch(`https://backend-mywf.onrender.com/api/etiqueta/actualizar/${o}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(d)})).ok)throw new Error;alert("✅ Etiqueta actualizada"),a(s.map(j=>j.id===o?{...j,...d}:j)),m(c.map(j=>j.id===o?{...j,...d}:j)),b(!1),i("")}catch{alert("❌ Error al actualizar etiqueta")}},v=async g=>{if(confirm("¿Eliminar esta etiqueta?"))try{if(!(await fetch(`https://backend-mywf.onrender.com/api/etiqueta/eliminar/${g}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).ok)throw new Error;const j=s.filter(x=>x.id!==g);a(j),m(j)}catch{alert("❌ Error al eliminar")}};return e.jsxs("div",{className:"form-container",children:[e.jsx("h2",{children:"Actualizar Etiquetas"}),l?e.jsxs("form",{onSubmit:w,className:"form-content",children:[e.jsx("input",{type:"text",name:"nombre",value:d.nombre,onChange:N,className:"form-input",required:!0}),e.jsx("textarea",{name:"descripcion",value:d.descripcion,onChange:N,className:"form-input",required:!0}),e.jsx("button",{type:"submit",className:"form-button",children:"Guardar Cambios"}),e.jsx("button",{type:"button",className:"cancel-button",onClick:()=>{b(!1),i("")},children:"Cancelar"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-content",children:[e.jsx("label",{children:"Buscar por Nombre:"}),e.jsx("input",{type:"text",className:"form-input",value:r,onChange:g=>p(g.target.value),placeholder:"Ingrese un nombre"})]}),e.jsx("ul",{className:"etiquetas-list",children:c.map(g=>e.jsxs("li",{children:[e.jsx("strong",{children:"Nombre:"})," ",g.nombre," ",e.jsx("br",{}),e.jsx("strong",{children:"Descripción:"})," ",g.descripcion,e.jsx("br",{}),e.jsx("button",{onClick:()=>y(g.id),className:"edit-button3",children:"Editar"}),e.jsx("button",{onClick:()=>v(g.id),className:"delete-button3",children:"Eliminar"}),e.jsx("hr",{})]},g.id))})]})]})},ms=()=>{const[s,a]=n.useState(null);return e.jsxs("div",{className:"admin-container",children:[e.jsx("h1",{className:"admin-title",children:"Gestión de Etiquetas"}),e.jsxs("div",{className:"admin-buttons-container",children:[e.jsx("button",{className:"admin-button button-crear",onClick:()=>a("crear"),children:"Crear Etiqueta"}),e.jsx("button",{className:"admin-button button-editar",onClick:()=>a("editar"),children:"Actualizar Etiqueta"})]}),e.jsxs("div",{className:"admin-module-container",style:{marginTop:"20px"},children:[s==="crear"&&e.jsx(cs,{}),s==="editar"&&e.jsx(ds,{})]})]})},K=()=>{const[s,a]=n.useState(!1),[c,m]=n.useState("");return n.useEffect(()=>{const o=localStorage.getItem("token"),i=localStorage.getItem("tipoUsuario");a(!!o),m(i)},[]),s?e.jsx(le,{to:"/"}):e.jsx("main",{className:"flex justify-center content-center w-full h-screen",children:e.jsx(oe,{})})},T=({children:s,allowedRoles:a})=>{const c=localStorage.getItem("token"),m=localStorage.getItem("tipoUsuario");return!c||a&&!a.includes(m)?e.jsx(le,{to:"/"}):s};function us(){return e.jsx(Ue,{children:e.jsx(qe,{children:e.jsx(De,{children:e.jsx(Se,{children:e.jsx("div",{className:"app-container",children:e.jsx("div",{className:"main-content",children:e.jsxs(ke,{children:[e.jsxs(I,{path:"/",element:e.jsx(Le,{}),children:[e.jsx(I,{index:!0,element:e.jsx(Re,{})}),e.jsx(I,{path:"productos/:id",element:e.jsx(Te,{})}),e.jsx(I,{path:"searches",element:e.jsx(Ze,{})})," ",e.jsx(I,{path:"perfil",element:e.jsx(T,{allowedRoles:["admin","usuario","moderador"],children:e.jsx(Ge,{})})}),e.jsx(I,{path:"eventos",element:e.jsx(T,{allowedRoles:["admin","moderador"],children:e.jsx(Xe,{})})}),e.jsx(I,{path:"disfraces",element:e.jsx(T,{allowedRoles:["admin","moderador"],children:e.jsx(ns,{})})}),e.jsx(I,{path:"etiquetas",element:e.jsx(T,{allowedRoles:["admin","moderador"],children:e.jsx(ms,{})})}),e.jsx(I,{path:"administradores",element:e.jsx(T,{allowedRoles:["admin"],children:e.jsx(ls,{})})})]}),e.jsx(I,{path:"/login",element:e.jsx(K,{}),children:e.jsx(I,{index:!0,element:e.jsx(Be,{})})}),e.jsx(I,{path:"/register",element:e.jsx(K,{}),children:e.jsx(I,{index:!0,element:e.jsx(Oe,{})})}),e.jsx(I,{path:"/confirm/:token",element:e.jsx(Je,{})}),e.jsx(I,{path:"/forgot/id",element:e.jsx(_e,{})}),e.jsx(I,{path:"/recuperar-password/:token",element:e.jsx(He,{})}),e.jsx(I,{path:"*",element:e.jsx(Ye,{})})]})})})})})})})}ze.createRoot(document.getElementById("root")).render(e.jsx(n.StrictMode,{children:e.jsx(us,{})}));
